<!DOCTYPE html>
<html lang="es-PE">

<head>
    <title>CRUD</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <meta name="keywords"
        content="AS-TESIS,AS-Tesis,Grupo Ases ,asesoría académica, asesores de proyectos de investigación, ética académica, excelencia, desarrollo personal, equipo calificado, éxito académico, transformación de ideas, orientación académica, apoyo en tesis, consultores de investigación, proyectos sólidos, acompañamiento académico, estudiantes, consultoría académica">
    


    <!--CDN de BOOTStrap -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous" /> -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css" /> -->
<!-- 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"> -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8.3.1/swiper-bundle.min.css" />
    <link href="https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css" rel="stylesheet" />
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" /> -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/2.0.5/css/dataTables.bootstrap4.css" rel="stylesheet">
    <!-- ====== LINKS EXTERNOS ====== -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- <link href="glightbox/css/glightbox.min.css" rel="stylesheet"> -->

    <!-- <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet"> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <!--ESTILOS ADICIONALES AGREGADOS-->
    <link rel="stylesheet" href="../resource/css/personas.css" rel="stylesheet">

</head>


<body>

    <div class="container">
        
        <a class="btn btn-primary mt-4" data-bs-toggle="modal" data-bs-target="#modalregister">Registrate</a>
        <table class="table table-bordered table-striped text-center mt-4">
            <thead>
              <tr>
                <th scope="col">ID</th>
                <th scope="col">Dni</th>
                <th scope="col">Nombre</th>
                <th scope="col">Imagen</th>
                <th scope="col">Acciones</th>
              </tr>
            </thead>
            <tbody>
                <% results.forEach((personas) => { %>
              <tr>
                <td><%=personas.id %></td>
                <td><%=personas.dni %></td>
                <td><%=personas.nombre %></td>
                <td><%=personas.imagen %></td>
                <td>
                    <a href="#" data-bs-toggle="modal" data-bs-target="#modalupdate_<%=personas.id %>"  id="modificar" class="btn btn-outline-info">Editar</a>
                    
                    <a href="/eliminar/<%=personas.id %>"class="btn btn-outline-warning">Eliminar</a>
                </td>
              </tr>
            <% }) %>
            </tbody>
          </table>
        
    </div>

    <!-- Modal Formulario Insertar-->
    <div class="modal fade" id="modalregister" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg-4">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">SISTEMAS</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                        <form action="/newperson" method="POST" enctype="multipart/form-data" id="form2" class="form_container"   >
        
                            <div class="title_container">
                                <p class="title">Registrarte</p>
                            </div>
                            <div class="input_container">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person-badge" viewBox="0 0 16 16">
                                    <path d="M0 0h16v16H0V0zm13.684 11.68c.837-.725 1.316-1.743 1.316-2.826 0-2.206-2.111-4-4.737-4S5.526 6.648 5.526 8.853c0 1.083.48 2.101 1.316 2.826C4.18 11.858 2 13.644 2 14.66V15c0 .182.147.34.331.34h11.338c.184 0 .331-.158.331-.34v-.34c0-1.016-2.18-2.802-4.316-3.98zM8 3.5c.97 0 1.753-.784 1.753-1.75C9.753.784 8.97 0 8 0S6.247.784 6.247 1.75c0 .966.783 1.75 1.753 1.75z"/>
                                    <path d="M8 8a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm0 1.5c-.402 0-.751-.224-1.03-.55.119-.215.338-.45.646-.684.407-.337.872-.648 1.385-.935.512.287.978.598 1.385.935.307.234.526.469.646.684-.279.326-.628.55-1.03.55z"/>
                                  </svg>
                                <input placeholder="Dni" name="dni" type="number" class="input_field" id="dni">
                            </div>
                            <div class="input_container">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                                        class="iconoForm icon bi bi-person-circle" viewBox="0 0 16 16">
                                        <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z" fill="#000000"></path>
                                        <path fill-rule="evenodd"
                                            d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"
                                            fill="#000000"></path>
                                    </svg>
                                <input placeholder="Nombre" name="nombre" type="text" class="input_field" id="nombre">
                            </div>
                            
                            <div class="input_container">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-phone" viewBox="0 0 16 16">
                                    <path d="M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h6zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H5z"/>
                                    <path d="M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                                  </svg>
                                <input placeholder="Imagen" name="imagen" type="file" class="input_field" id="imagen" onchange="mostrarVistaPrevia()">
                            </div>
                            <div id="vistaPreviaContainer" class="text-center">
                                <img id="vistaPreviaImagen" src="#" alt="Vista previa de la imagen" class="img-thumbnail">
                            </div>
                            <div class="input_container">
                                <input type="submit" id="btnF2" value="Agregar" class="wpcf7-form-control has-spinner wpcf7-submit submit">
                                <a href="crudpersonas" id="btnF2" class="wpcf7-form-control has-spinner wpcf7-submit submit">Cancelar</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
    </div>
    
    <!-- Fin del Modal Insertar -->

    <!-- Modal Formulario Editar -->
    <% results.forEach((personas) => { %>
    <div class="modal fade" id="modalupdate_<%=personas.id %>" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg-4">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">SISTEMA</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                        <form id="form2" class="form_container" action="/updateperson" method="POST" enctype="multipart/form-data">
                            
                            <div class="title_container">
                                <p class="title">Modificar</p>
                            </div>
                            <div class="mb-3">
                                <label for="id" class="form-label" hidden>Id</label>
                                <input type="text" class="form-control" id="id" name="id" tabindex="1" value="<%=personas.id %>" hidden>
                            </div>
                            <label for="id" class="form-label">Dni:</label>
                            <div class="input_container">
                                <input placeholder="78945612" name="dni" type="number" class="input_field" id="dni" value="<%=personas.dni%>">
                            </div>
                            <label for="id" class="form-label">Nombre:</label>
                            <div class="input_container">
                                <input placeholder="Nombre" name="nombre" type="text" class="input_field" id="nombre" value="<%=personas.nombre %>">
                            </div>
                            <!-- <div id="vistaPreviaContainer" class="text-center">
                                <img src="../uploads/<%=personas.imagen %>" alt="<%=personas.imagen %>" class="img-fluid rounded mx-auto d-block">
                            </div> -->
                            <label for="id" class="form-label">Imagen:</label>
                            <div class="input_container">
                                <input placeholder="Imagen" name="imagen" type="file" class="input_field" id="imagen" onchange="mostrarVistaPrevia()">
                            </div>
                            <div id="vistaPreviaContainer" class="text-center">
                                <img id="vistaPreviaImagen" src="../resource/img/<%=personas.imagen %>" alt="<%=personas.imagen %>" class="img-fluid rounded mx-auto d-block">
                            </div>
                            <div class="input_container">
                                <button type="submit" class="btn btn-success" tabindex="5">Guardar</button>
                                <a href="crudpersonas" id="btnF2" class="wpcf7-form-control has-spinner wpcf7-submit submit">Cancelar</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    <% }) %>
    <script>
        function mostrarVistaPrevia() {
            var archivo = document.querySelector('input[type=file]').files[0];
            var vistaPrevia = document.getElementById('vistaPreviaImagen');
    
            if (archivo) {
                var lector = new FileReader();
                lector.onload = function(e) {
                vistaPrevia.src = e.target.result;
                vistaPrevia.style.display = 'block';
            }
            lector.readAsDataURL(archivo);
    }
        }
    </script>
    <!-- Fin del Modal Editar -->
         <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

        <script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/swiper@8.3.1/swiper-bundle.min.js"></script>
        <script src="https://kit.fontawesome.com/1f4346c153.js" crossorigin="anonymous"></script> 
    </body>
    </html>